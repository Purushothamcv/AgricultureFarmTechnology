# Plant Disease Detection - System Architecture

## ğŸ—ï¸ Complete System Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT (Frontend)                           â”‚
â”‚                   React / Vue / JavaScript / Mobile                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ HTTP POST
                               â”‚ multipart/form-data
                               â”‚ Image File
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FASTAPI BACKEND                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚               main_fastapi.py (App Entry)                    â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  @app.on_event("startup")                                    â”‚  â”‚
â”‚  â”‚    â””â”€â–º plant_disease_startup()                              â”‚  â”‚
â”‚  â”‚         â”œâ”€â–º Extract 37 classes from dataset folders         â”‚  â”‚
â”‚  â”‚         â”œâ”€â–º Create class mapping {0: "Class_1", ...}        â”‚  â”‚
â”‚  â”‚         â””â”€â–º Load plant_disease_prediction_model.h5          â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  POST /predict/plant-disease                                 â”‚  â”‚
â”‚  â”‚    â””â”€â–º Routes to plant_disease_service                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          plant_disease_service.py (Core Logic)               â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ STEP 1: Validate Request                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ Check file type (image/jpeg, image/png)           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ Validate file exists                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ Check model is loaded                              â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                             â”‚                                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ STEP 2: Load & Preprocess Image                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ Read image bytes                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ Open with PIL                                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ Convert to RGB (handles grayscale/RGBA)           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ Resize to 224x224                                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ Convert to numpy array                             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ Normalize: array / 255.0 â†’ [0, 1]                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ Add batch dimension: (224,224,3) â†’ (1,224,224,3)  â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                             â”‚                                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ STEP 3: Run Model Prediction                           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ model.predict(image_array)                         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ Output: [0.02, 0.91, 0.01, ..., 0.04] (37 values) â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                             â”‚                                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ STEP 4: Process Results                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ Sort predictions by confidence                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ Get top 3 indices: [1, 5, 12]                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ Map to class names:                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚   1 â†’ "Tomato___Late_blight" (0.91)                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚   5 â†’ "Tomato___Early_blight" (0.06)               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚   12 â†’ "Tomato___healthy" (0.03)                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ Extract plant name: "Tomato"                       â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                             â”‚                                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ STEP 5: Format Response                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  {                                                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    "plant": "Tomato",                                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    "prediction": "Tomato___Late_blight",               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    "confidence": 0.91,                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    "top_3": [...]                                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  }                                                      â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ JSON Response
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT (Frontend)                           â”‚
â”‚                    Display Results to User                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        DEPENDENT RESOURCES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¦ TRAINED MODEL                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  File: model/plant_disease_prediction_model.h5                 â”‚ â”‚
â”‚  â”‚  Size: 547 MB                                                  â”‚ â”‚
â”‚  â”‚  Type: Keras Sequential/Functional Model                       â”‚ â”‚
â”‚  â”‚  Input: (224, 224, 3) RGB image                                â”‚ â”‚
â”‚  â”‚  Output: (37,) probability distribution                        â”‚ â”‚
â”‚  â”‚  Status: âœ… Pre-trained (NO RETRAINING)                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ DATASET (Class Labels Source)                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Path: data/plant-village dataset/plantvillage dataset/color/  â”‚ â”‚
â”‚  â”‚  Structure: ImageFolder (37 class folders)                     â”‚ â”‚
â”‚  â”‚  Purpose: Dynamic class name extraction                        â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚  Sample Classes:                                               â”‚ â”‚
â”‚  â”‚    â”œâ”€ Apple___Apple_scab/                                      â”‚ â”‚
â”‚  â”‚    â”œâ”€ Apple___Black_rot/                                       â”‚ â”‚
â”‚  â”‚    â”œâ”€ Tomato___Late_blight/                                    â”‚ â”‚
â”‚  â”‚    â”œâ”€ Tomato___Early_blight/                                   â”‚ â”‚
â”‚  â”‚    â””â”€ ... (33 more)                                            â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚  Process:                                                       â”‚ â”‚
â”‚  â”‚    1. List all subdirectories                                  â”‚ â”‚
â”‚  â”‚    2. Sort alphabetically                                      â”‚ â”‚
â”‚  â”‚    3. Create index mapping {0: "Apple___Apple_scab", ...}     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        STARTUP SEQUENCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1ï¸âƒ£  START APPLICATION
    â””â”€â–º uvicorn main_fastapi:app --reload

2ï¸âƒ£  INITIALIZE FASTAPI
    â””â”€â–º Create FastAPI app instance

3ï¸âƒ£  RUN STARTUP EVENTS
    â”œâ”€â–º Connect to MongoDB
    â”œâ”€â–º Initialize fruit disease models (existing)
    â””â”€â–º Initialize plant disease detection â­ NEW
         â”‚
         â”œâ”€â–º Extract class names from dataset
         â”‚    â””â”€â–º Read folder names from dataset/color/
         â”‚        â””â”€â–º Sort alphabetically
         â”‚            â””â”€â–º ["Apple___Apple_scab", "Apple___Black_rot", ...]
         â”‚
         â”œâ”€â–º Create class mapping
         â”‚    â””â”€â–º {0: "Apple___Apple_scab", 1: "Apple___Black_rot", ...}
         â”‚
         â””â”€â–º Load model
              â””â”€â–º keras.models.load_model("model/plant_disease_prediction_model.h5")
                   â””â”€â–º âœ… Model loaded (547 MB)

4ï¸âƒ£  REGISTER ROUTES
    â””â”€â–º Include plant_disease_router
         â”œâ”€â–º POST /predict/plant-disease
         â””â”€â–º GET /predict/plant-disease/health

5ï¸âƒ£  START SERVER
    â””â”€â–º Listening on http://localhost:8000
         â””â”€â–º âœ… Ready to accept requests


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        REQUEST FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¤ CLIENT REQUEST
   â”‚
   â””â”€â–º POST http://localhost:8000/predict/plant-disease
        â”œâ”€ Headers: Content-Type: multipart/form-data
        â””â”€ Body: file=<image_bytes>

ğŸ”„ FASTAPI ROUTING
   â”‚
   â””â”€â–º Route to: plant_disease_service.predict_plant_disease()

âœ… VALIDATION
   â”‚
   â”œâ”€â–º Check: Is model loaded?
   â”œâ”€â–º Check: Is file type image/*?
   â””â”€â–º Check: Can image be opened?

ğŸ–¼ï¸  IMAGE PREPROCESSING
   â”‚
   â”œâ”€â–º Read image bytes
   â”œâ”€â–º PIL.Image.open()
   â”œâ”€â–º Convert to RGB
   â”œâ”€â–º Resize to (224, 224)
   â”œâ”€â–º Normalize to [0, 1]
   â””â”€â–º Add batch dimension

ğŸ¤– MODEL INFERENCE
   â”‚
   â”œâ”€â–º model.predict(image_array)
   â””â”€â–º Output: [0.02, 0.91, 0.01, ..., 0.04]

ğŸ“Š RESULT PROCESSING
   â”‚
   â”œâ”€â–º Sort by confidence
   â”œâ”€â–º Get top 3 indices
   â”œâ”€â–º Map to class names
   â””â”€â–º Extract plant name

ğŸ“¥ CLIENT RESPONSE
   â”‚
   â””â”€â–º JSON:
        {
          "plant": "Tomato",
          "prediction": "Tomato___Late_blight",
          "confidence": 0.91,
          "top_3": [...]
        }


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        ERROR HANDLING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ 400 BAD REQUEST
   â”œâ”€ Invalid file type (not an image)
   â””â”€ Corrupt/unreadable image

âŒ 500 INTERNAL SERVER ERROR
   â”œâ”€ Model prediction failed
   â”œâ”€ Image preprocessing error
   â””â”€ Unexpected exception

âŒ 503 SERVICE UNAVAILABLE
   â””â”€ Model not loaded (startup failed)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        KEY DESIGN DECISIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… DYNAMIC CLASS EXTRACTION
   Why: No hardcoded classes, flexible to dataset changes
   How: Read folder names from dataset directory

âœ… SINGLE MODEL LOAD
   Why: Performance (avoid loading 547 MB per request)
   How: Load at startup, store globally

âœ… STANDARD PREPROCESSING
   Why: Match training pipeline for accurate predictions
   How: RGB conversion, resize, normalize [0,1]

âœ… TOP-K PREDICTIONS
   Why: Give users confidence in results
   How: Sort predictions, return top 3 with confidence

âœ… PROFESSIONAL ERROR HANDLING
   Why: Production-ready, user-friendly
   How: Try-catch blocks, HTTP status codes, clear messages


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        TESTING STRATEGY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1ï¸âƒ£  UNIT TESTING
   â”œâ”€ Test class extraction
   â”œâ”€ Test model loading
   â”œâ”€ Test preprocessing
   â””â”€ Test prediction logic

2ï¸âƒ£  INTEGRATION TESTING
   â”œâ”€ Test health check endpoint
   â”œâ”€ Test prediction endpoint
   â”œâ”€ Test with sample images
   â””â”€ Test error handling

3ï¸âƒ£  END-TO-END TESTING
   â””â”€ test_plant_disease.py
       â”œâ”€ Health check
       â”œâ”€ Sample predictions
       â””â”€ Error cases


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        DEPLOYMENT CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Code
   â”œâ”€ plant_disease_service.py (implemented)
   â”œâ”€ main_fastapi.py (integrated)
   â””â”€ test_plant_disease.py (created)

âœ… Resources
   â”œâ”€ Model file (547 MB) âœ“
   â”œâ”€ Dataset folders (37 classes) âœ“
   â””â”€ Dependencies (requirements.txt) âœ“

âœ… Configuration
   â”œâ”€ CORS enabled âœ“
   â”œâ”€ File upload enabled âœ“
   â””â”€ Error handling âœ“

âœ… Testing
   â”œâ”€ Verification script âœ“
   â”œâ”€ Test suite âœ“
   â””â”€ Health check âœ“

âœ… Documentation
   â”œâ”€ Implementation guide âœ“
   â”œâ”€ Quick reference âœ“
   â”œâ”€ API documentation âœ“
   â””â”€ Architecture diagram âœ“ (this file)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        PERFORMANCE METRICS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â±ï¸  STARTUP TIME: 5-10 seconds
   â””â”€ Model loading: ~5s
   â””â”€ Class extraction: <1s

â±ï¸  PREDICTION TIME: 100-500ms
   â”œâ”€ Image preprocessing: ~50ms
   â”œâ”€ Model inference: ~50-400ms (depends on hardware)
   â””â”€ Result formatting: <10ms

ğŸ’¾ MEMORY USAGE: 500MB - 2GB
   â”œâ”€ TensorFlow runtime: ~500MB
   â”œâ”€ Model weights: ~547MB
   â””â”€ Other: ~200MB-1GB

ğŸ“Š THROUGHPUT: ~2-10 requests/sec
   â””â”€ Depends on hardware (CPU vs GPU)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
